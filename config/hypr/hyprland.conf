# Hyprland Configuration
# Base config - shared across all machines
# Host-specific settings are sourced from ~/.config/hypr/host.conf

###################
### HOST CONFIG ###
###################

# Source host-specific config (monitor, scaling, hardware-specific env vars)
source = ~/.config/hypr/host.conf

###################
### MY PROGRAMS ###
###################

## Autostart
exec-once = waybar
exec-once = hyprpaper -c ~/.config/hypr/hyprpaper.conf
exec-once = hyprshot
exec-once = mako
exec-once = /usr/lib/hyprpolkitagent/hyprpolkitagent

#############################
### ENVIRONMENT VARIABLES ###
#############################

## Shared environment variables
env = XCURSOR_THEME,Bibata-Modern-Ice
env = HYPRCURSOR_THEME,Bibata-Modern-Ice

# Wayland basics
env = GDK_BACKEND,wayland
env = QT_QPA_PLATFORM,wayland
env = QT_QPA_PLATFORMTHEME,qt6ct
env = ELECTRON_OZONE_PLATFORM_HINT,wayland
env = MOZ_ENABLE_WAYLAND,1
env = MOZ_WEBRENDER,1

# XDG Portal configuration
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = GTK_USE_PORTAL,1

###################
### PERMISSIONS ###
###################

ecosystem {
    enforce_permissions = 1
}

permission = /usr/bin/grim, screencopy, allow
permission = /usr/lib/xdg-desktop-portal-hyprland, screencopy, allow
permission = /usr/bin/hyprpm, plugin, allow

###################
### GENERAL ###
###################

general {
    gaps_in = 1
    gaps_out = 1
    border_size = 0
    layout = dwindle
    no_border_on_floating = false
}

dwindle {
    pseudotile = false
    preserve_split = true
    smart_split = true
    smart_resizing = true
}

animations {
    enabled = false
}

misc {
    force_default_wallpaper = 0
    disable_hyprland_logo = true
    disable_splash_rendering = true
    vfr = true
    vrr = 0
    enable_swallow = true
    focus_on_activate = true
    mouse_move_enables_dpms = true
    key_press_enables_dpms = true
}

input {
    kb_layout = us
    kb_variant = intl
    follow_mouse = 1
    sensitivity = 0
    accel_profile = flat
    force_no_accel = false
}

###################
### KEYBINDINGS ###
###################

$mainMod = SUPER

# Application shortcuts
bind = $mainMod, B, exec, chromium
bind = $mainMod, E, exec, thunar
bind = $mainMod, F, fullscreen
bind = $mainMod, J, togglesplit
bind = $mainMod, M, exec, wofi --show drun
bind = $mainMod SHIFT, M, exec, wofi --show run
bind = $mainMod, P, exec, hyprshot -m region
bind = $mainMod, Q, killactive
bind = $mainMod SHIFT, Q, forcekillactive
bind = $mainMod SHIFT, R, exec, ~/.config/hypr/reload-hyprland.sh
bind = $mainMod, S, togglespecialworkspace, magic
bind = $mainMod SHIFT, S, movetoworkspace, special:magic
bind = $mainMod, V, togglefloating
bind = $mainMod, C, exec, codium
bind = $mainMod, T, exec, wezterm
bind = $mainMod, RETURN, exec, wezterm

# Focus movement (vim motions)
bind = $mainMod, h, movefocus, l
bind = $mainMod, l, movefocus, r
bind = $mainMod, k, movefocus, u
bind = $mainMod, j, movefocus, d
bind = $mainMod, tab, cyclenext

# Move windows (vim motions)
bind = $mainMod SHIFT, h, movewindow, l
bind = $mainMod SHIFT, l, movewindow, r
bind = $mainMod SHIFT, k, movewindow, u
bind = $mainMod SHIFT, j, movewindow, d

# Resize windows (vim motions)
bind = $mainMod CTRL, h, resizeactive, -20 0
bind = $mainMod CTRL, l, resizeactive, 20 0
bind = $mainMod CTRL, k, resizeactive, 0 -20
bind = $mainMod CTRL, j, resizeactive, 0 20

# Workspaces
bind = $mainMod, 1, workspace, 1
bind = $mainMod, 2, workspace, 2
bind = $mainMod, 3, workspace, 3
bind = $mainMod, 4, workspace, 4
bind = $mainMod, 5, workspace, 5
bind = $mainMod, 6, workspace, 6
bind = $mainMod, 7, workspace, 7
bind = $mainMod, 8, workspace, 8
bind = $mainMod, 9, workspace, 9
bind = $mainMod, 0, workspace, 10

# Move windows to workspaces
bind = $mainMod SHIFT, 1, movetoworkspace, 1
bind = $mainMod SHIFT, 2, movetoworkspace, 2
bind = $mainMod SHIFT, 3, movetoworkspace, 3
bind = $mainMod SHIFT, 4, movetoworkspace, 4
bind = $mainMod SHIFT, 5, movetoworkspace, 5
bind = $mainMod SHIFT, 6, movetoworkspace, 6
bind = $mainMod SHIFT, 7, movetoworkspace, 7
bind = $mainMod SHIFT, 8, movetoworkspace, 8
bind = $mainMod SHIFT, 9, movetoworkspace, 9
bind = $mainMod SHIFT, 0, movetoworkspace, 10

# Volume and brightness
bindel = , XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+
bindel = , XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindl = , XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindl = , XF86AudioMicMute, exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle

# Mouse bindings
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

###################
### WINDOW RULES ###
###################

windowrulev2 = float, class:^(pavucontrol)$
windowrulev2 = float, class:^(blueman-manager)$
windowrulev2 = float, class:^(nm-connection-editor)$
windowrulev2 = float, class:^(org.kde.dolphin)$
windowrulev2 = size 800 600, class:^(org.kde.dolphin)$
windowrulev2 = center, class:^(org.kde.dolphin)$

# XWayland windows
windowrulev2 = rounding 0, xwayland:1
windowrulev2 = forcergbx, xwayland:1

# Zed editor specific
windowrulev2 = size 80% 80%, class:^(Zed)$
